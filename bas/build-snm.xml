<?xml version="1.0"?>
<project name="net.bodz.bas" default="default">

	<property environment="env" />
	<property name="distdir" value="${env.JAVA_LIB}" />
	<property name="distsrc" value="${env.JAVA_SRC}" />

	<target name="default" depends="dist">
	</target>

	<target name="dist" depends=":bin.jar, :src.jar">
		<copy todir="${distdir}">
			<fileset file="${basedir}/lib/*.jar">
				<exclude name="*-src.jar" />
			</fileset>
		</copy>
		<copy todir="${distsrc}">
			<fileset file="${basedir}/lib/*-src.jar" />
		</copy>
	</target>

	<target name=":bin.jar">
		<mkdir dir="lib" />
		<jar destfile="lib/net.bodz.bas.jar" update="true">
			<fileset dir="mod/_MODEL/bin" />
			<fileset dir="mod/Application Framework/bin" />
			<fileset dir="mod/B-IOS Framework/bin" />
			<fileset dir="mod/Bundled Modules/bin" />
			<fileset dir="mod/Data Types/bin" />
			<fileset dir="mod/Database Abstraction/bin" />
			<fileset dir="mod/Functional Programming/bin" />
			<fileset dir="mod/Language Extension/bin" />
			<fileset dir="mod/System Utilities/bin" />
			<fileset dir="mod/Text Process/bin" />
			<fileset dir="mod/Wrapper Classes/bin" />
		</jar>
	</target>

	<target name=":src.jar">
		<mkdir dir="lib" />
		<jar destfile="lib/net.bodz.bas-src.jar" update="true">
			<fileset dir="mod/_MODEL/src" />
			<fileset dir="mod/Application Framework/src" />
			<fileset dir="mod/B-IOS Framework/src" />
			<fileset dir="mod/Bundled Modules/src" />
			<fileset dir="mod/Data Types/src" />
			<fileset dir="mod/Database Abstraction/src" />
			<fileset dir="mod/Functional Programming/src" />
			<fileset dir="mod/Language Extension/src" />
			<fileset dir="mod/System Utilities/src" />
			<fileset dir="mod/Text Process/src" />
			<fileset dir="mod/Wrapper Classes/src" />
		</jar>
	</target>

	<target name="loadertest.jar">
		<mkdir dir="lib" />
		<jar destfile="lib/loadertest.jar">
			<fileset dir="mod/Application Framework/bin">
				<include name="net/bodz/bas/a/LoadBy.class" />
				<include name="net/bodz/bas/loader/BundledLoader.class" />
				<include name="net/bodz/bas/loader/LoaderTest.class" />
			</fileset>
		</jar>
	</target>

	<target name="testbats" depends=":bin.jar">
		<taskdef name="mkbat" classname="net.bodz.bas.cli.util.MkbatTask">
			<classpath path="lib/net.bodz.bas.jar" />
		</taskdef>
		<mkbat outdir="bin">
			<srcdir path="mod/Application Framework/bin" />
		</mkbat>
	</target>

	<target name="clean">
		<delete verbose="true">
			<fileset dir="${basedir}/lib" includes="*.jar" />
		</delete>
	</target>

</project>
