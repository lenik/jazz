<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper 
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mi">

    <resultMap id="map1" type="net.bodz.lily.model.base.CoMomentInterval" extends="co.MAP_ALL">
        <result property="beginDate" column="t0" />
        <result property="endDate" column="t1" />
    </resultMap>

    <sql id="setT">
        <if test="beginDate != null">t0 = #{beginDate}, </if>
        <if test="endDate != null">t1 = #{endDate}, </if>
    </sql>
    
    <sql id="set1">
        <include refid="co.setUVSA" />
        <include refid="mi.setT" />
    </sql>
    
    <sql id="filterSql">
        <if test="m.dateRange != null">
            <if test="m.dateRange.start != null">and t0 >= #{m.dateRange.start}</if>
            <if test="m.dateRange.end != null">
                <if test="m.dateRange.inclusiveEnd">and t1 &lt;= #{m.dateRange.end}</if>
                <if test="! m.dateRange.inclusiveEnd">and t1 &lt; #{m.dateRange.end}</if>
            </if>
        </if>
        <if test="m.year != null">and extract(year from t0) = #{m.year}</if>
        <if test="m.started == true">and t0 is not null</if>
        <if test="m.started == false">and t0 is null</if>
        <if test="m.ended == true">and t1 is not null</if>
        <if test="m.ended == false">and t1 is null</if>
    </sql>

</mapper>
